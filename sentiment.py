import re
from textblob import TextBlob
import sqlite3
from sqlite3 import Error





def get_data(conn):
    conn.text_factory = str
    cur = conn.cursor()

    authors = ["4dolfin", "7_Pixel_7", "9754213680632", "AVZ_Gone", "AbstrakThought", "AdvancedFish",
               "AnonymousButterfly01", "BAJJAB001",
               "BestOldExFriendRay", "Bronzehawkattack", "CanNotLiveLikeThis", "Cri1654", "Damn_Madame", "Eric2517",
               "Ge0rgeBr0ughton", "Gtj_2036",
               "IsAFailure", "Ivoriy", "KnowThat205", "Kookie_212", "KriegRipper"]

    query1 = """ select author, strftime('%Y %W', date(post_date, 'unixepoch') ), avg(score) from submissions where author in ( "4dolfin", "7_Pixel_7", 
                   "9754213680632", "AVZ_Gone", "AbstrakThought", "AdvancedFish", "AnonymousButterfly01", "BAJJAB001",
                   "BestOldExFriendRay","Bronzehawkattack", "CanNotLiveLikeThis","Cri1654", "Damn_Madame","Eric2517","Ge0rgeBr0ughton", "Gtj_2036",
                   "IsAFailure","Ivoriy", "KnowThat205", "Kookie_212",  "KriegRipper")
                     group by author, strftime('%Y %W', date(post_date, 'unixepoch'));"""

    cur.execute(query1)

    '''
    KriegRipper | 2018 32 | 44.0
    KriegRipper | 2018 33 | 3.0
    KriegRipper | 2018 34 | 75.0
    
    '''

    fetchedData = cur.fetchall()

    for everyAuthor1 in authors:

        average_score = {}

        for i in range(len(fetchedData)):

            singleTuple = fetchedData[i]

            if singleTuple[0] == everyAuthor1:

                average_score[singleTuple[1]] = singleTuple[2]

        print ("\n\n This is for author :")
        print everyAuthor1

        print ("\n")
        print average_score







def main():
    """ create a database connection to a SQLite database """
    conn = sqlite3.connect("submissions.db")

    get_data(conn)
    conn.commit()
    conn.close()


if __name__ == "__main__":
    # calling main function
    main()


###########

'''

result:



 This is for author :
4dolfin


{'2016 47': 36.5, '2017 34': 10.0, '2017 50': 1.3333333333333333, '2016 12': 6.0, '2016 49': 11.5, '2017 17': 0.0, '2018 02': 3.0, '2016 50': 2.0, '2016 38': 55.5, '2015 29': 5.0, '2015 28': 34.0, '2015 05': 2.0, '2015 19': 5.0, '2016 33': 3.0, '2015 24': 0.0, '2015 27': 1.0, '2015 26': 4.0, '2015 20': 1.0, '2015 23': 3.3333333333333335, '2015 22': 2.0, '2016 44': 4.0, '2015 08': 13.0, '2017 25': 2.0, '2015 47': 1.0, '2015 46': 2.5, '2015 45': 209.0, '2015 44': 5.5, '2015 43': 10.666666666666666, '2015 42': 13.333333333333334, '2016 36': 33.0, '2018 17': 2.0, '2017 22': 1.0, '2017 47': 1.5, '2018 16': 2.5, '2016 34': 7.0, '2017 29': 1.5, '2016 03': 15.0, '2016 01': 57.5, '2017 08': 1.0, '2016 04': 5.5, '2017 05': 3.0, '2017 04': 8.0, '2016 32': 21.0, '2018 14': 11.2, '2018 13': 21.0, '2018 12': 613.0, '2018 11': 14.25, '2018 01': 13.0, '2015 10': 98.0, '2016 29': 136.66666666666666, '2015 12': 72.0, '2017 51': 9.0, '2015 15': 4.0, '2016 48': 14.0, '2015 17': 7.0, '2016 46': 17.0, '2015 33': 13.5, '2015 30': 5.0, '2016 42': 2.0, '2015 34': 12.0, '2017 46': 7.5, '2017 49': 4.5, '2014 51': 3.0, '2017 48': 20.11111111111111, '2015 50': 11.5, '2015 51': 7.5, '2015 52': 17.0, '2017 37': 1.0, '2017 52': 6.0}


 This is for author :
7_Pixel_7


{'2017 30': 1.0, '2017 31': 2.0, '2017 32': 15.5, '2017 33': 117.0, '2017 51': 3.0, '2017 39': 1.5, '2018 06': 2.8, '2016 46': 2.0, '2017 40': 1.0, '2017 43': 1.0, '2016 23': 129.0, '2017 44': 2.0, '2017 07': 1.0, '2017 23': 1.0, '2017 22': 3.1538461538461537, '2017 21': 4.0, '2017 27': 234.0, '2017 24': 4.333333333333333, '2017 04': 0.5, '2017 29': 3.0, '2017 28': 0.0, '2017 48': 1.0, '2017 41': 2.0, '2016 47': 1.0, '2016 22': 2.0, '2016 45': 2.0, '2016 43': 0.0, '2017 47': 6.0, '2018 27': 1.0, '2018 24': 15.25, '2018 25': 2.0, '2018 23': 0.0, '2018 28': 5.25, '2018 29': 4.5}


 This is for author :
9754213680632


{'2018 19': 5.0, '2017 51': 3.0, '2018 31': 8.0, '2018 30': 4.0, '2018 33': 24.0, '2018 13': 4.0, '2018 34': 11.5, '2018 11': 3.0, '2018 10': 3.0, '2018 26': 4.0, '2018 24': 6.0, '2018 25': 4.0, '2018 22': 13.0, '2018 23': 8.0, '2018 21': 5.0, '2018 28': 8.5, '2017 45': 3.5, '2017 47': 2.0, '2018 29': 3.0}


 This is for author :
AVZ_Gone


{'2017 33': 1.0, '2017 34': 1.0, '2017 35': 9.0, '2017 37': 73.66666666666667, '2017 38': 1.0, '2017 39': 2.0, '2018 01': 31.0, '2018 02': 9.5, '2017 52': 4.333333333333333, '2018 31': 31.875, '2018 04': 1.0, '2018 18': 3.0, '2018 17': 16.333333333333332, '2018 30': 28.23076923076923, '2018 33': 663.9285714285714, '2018 32': 11.181818181818182, '2018 35': 11.11111111111111, '2018 34': 10.227272727272727, '2018 10': 0.0, '2017 49': 6.0, '2017 48': 1.0, '2017 47': 4.0, '2017 46': 3.0, '2018 26': 180.07692307692307, '2018 27': 24.0, '2018 24': 54.0, '2018 25': 4.25, '2018 22': 34.523809523809526, '2018 23': 4.8, '2018 21': 2.5, '2018 28': 268.5833333333333, '2018 29': 937.3333333333334}


 This is for author :
AbstrakThought


{'2017 30': 1.0, '2017 18': 81.0, '2017 19': 0.0, '2017 52': 4.666666666666667, '2017 35': 5.0, '2017 50': 3.0, '2017 12': 1.0, '2017 39': 3.0, '2017 10': 2.5, '2018 07': 53.0, '2017 16': 2.0, '2017 17': 2.0, '2018 02': 4.5, '2018 03': 6.0, '2017 27': 2.3333333333333335, '2017 26': 1.0, '2018 19': 4.0, '2018 32': 2.0, '2018 18': 3.0, '2017 38': 2.0, '2018 16': 1.0, '2017 29': 3.0, '2018 04': 3.0, '2017 23': 2.0, '2017 22': 3.0, '2017 21': 1.0, '2018 14': 5.0, '2017 09': 60.5, '2017 08': 5.5, '2018 08': 94.5, '2017 24': 2.3333333333333335, '2017 04': 7.0, '2017 07': 3.5, '2017 06': 4.0, '2017 01': 5.0, '2018 12': 85.0, '2018 11': 6.5, '2018 01': 8.0, '2017 49': 209.0, '2017 48': 2.5, '2017 41': 46.0, '2017 40': 0.0, '2017 43': 3.0, '2017 42': 1.0, '2017 45': 412.0, '2017 44': 1.0, '2017 46': 3.0, '2018 09': 416.0, '2018 15': 1.0, '2018 30': 1.0, '2018 26': 3.0, '2018 27': 102.0, '2018 24': 43.0, '2018 25': 1.0, '2018 28': 172.0, '2018 20': 5.0, '2018 21': 4.0, '2018 06': 89.0, '2018 10': 16.0}


 This is for author :
AdvancedFish


{'2018 33': 2.0, '2018 32': 13.666666666666666, '2018 23': 7.0, '2018 18': 0.0}


 This is for author :
AnonymousButterfly01


{'2018 08': 4.0, '2018 17': 25.0, '2018 05': 5.0, '2018 14': 9.0, '2018 35': 4.0, '2018 34': 6.0, '2018 30': 4.5, '2018 10': 1.5, '2017 49': 0.0, '2018 27': 1.0, '2018 25': 9.0, '2018 22': 2.0, '2018 23': 1.0, '2018 21': 133.0, '2017 40': 7.0, '2017 43': 2.0, '2017 47': 9.0}


 This is for author :
BAJJAB001


{'2017 31': 5.0, '2017 32': 122.4, '2017 33': 27.5, '2017 34': 151.0, '2017 35': 6.0, '2017 50': 171.33333333333334, '2017 37': 23.75, '2017 38': 6.0, '2017 39': 20.0, '2018 07': 11.0, '2018 33': 10.0, '2018 01': 2.0, '2018 02': 127.0, '2018 03': 73.33333333333333, '2017 52': 3.6666666666666665, '2018 09': 1.0, '2018 26': 6.5, '2017 36': 6.0, '2018 32': 19.75, '2017 51': 23.2, '2018 04': 106.0, '2018 05': 49.333333333333336, '2018 15': 1.0, '2018 14': 2.0, '2017 26': 3.0, '2017 25': 2.0, '2018 18': 15.0, '2018 31': 63.25, '2018 30': 37.0, '2017 29': 150.0, '2017 28': 5.666666666666667, '2018 13': 14.5, '2018 12': 0.0, '2018 11': 71.33333333333333, '2018 34': 14.0, '2017 49': 74.33333333333333, '2017 48': 1.0, '2017 43': 6.0, '2017 47': 15.5, '2018 19': 10.0, '2018 27': 94.0, '2018 24': 71.0, '2018 22': 46.0, '2018 23': 16.0, '2018 20': 4.0, '2018 21': 5.0, '2018 35': 3.0, '2018 29': 4.0}


 This is for author :
BestOldExFriendRay


{'2017 52': 1.0, '2018 09': 1.0, '2018 34': 4.25, '2017 51': 2.0, '2018 31': 10.666666666666666, '2018 05': 4.0, '2018 06': 1.0, '2018 07': 1.0, '2018 01': 35.0, '2018 02': 6.5, '2018 12': 3.6666666666666665, '2018 26': 8.0, '2018 24': 12.0, '2018 11': 55.0, '2018 18': 133.0, '2018 29': 25.0}


 This is for author :
Bronzehawkattack


{'2017 30': 35.0, '2017 32': 53.0, '2017 33': 6.0, '2015 18': 2.0, '2018 09': 42.0, '2018 04': 5.0, '2018 05': 3.0, '2018 06': 17.0, '2018 07': 17.0, '2018 03': 20.0, '2016 20': 9.0, '2015 01': 1.0, '2015 06': 8.0, '2018 08': 24.0, '2015 09': 1.0, '2015 21': 26.0, '2014 45': 1.0, '2015 42': 12.0, '2016 03': 5.0, '2018 16': 25.0, '2016 09': 35.0, '2018 11': 134.0, '2018 10': 72.0, '2015 10': 3.0, '2015 15': 6.5, '2016 48': 33.0, '2015 17': 0.0, '2016 46': 28.0, '2014 39': 14.0, '2016 25': 2.3333333333333335, '2015 51': 2.0, '2015 52': 27.0, '2018 27': 51.0, '2018 25': 95.0, '2018 20': 11.666666666666666}


 This is for author :
CanNotLiveLikeThis


{'2018 24': 4.0}


 This is for author :
Cri1654


{'2016 17': 5.0, '2016 11': 1.0, '2017 51': 80.0, '2017 10': 27.0, '2017 16': 1.5, '2017 18': 1.0, '2017 15': 4.0, '2016 51': 78.0, '2016 33': 0.0, '2017 34': 2.0, '2016 31': 0.0, '2016 30': 0.0, '2016 37': 16.0, '2015 30': 1.0, '2016 35': 10.0, '2016 34': 19.0, '2016 44': 3.0, '2015 26': 2.5, '2015 47': 18.0, '2016 42': 1.0, '2015 44': 1.0, '2015 43': 3.0, '2016 43': 3.0, '2018 30': 4.5, '2018 06': 23.5, '2017 23': 3.0, '2016 03': 2.0, '2016 05': 0.0, '2017 04': 1.0, '2017 06': 1.0, '2018 11': 26.0, '2017 02': 2.0, '2017 49': 1.0, '2016 49': 2.0, '2015 32': 1.5, '2016 22': 120.0, '2016 23': 59.0, '2015 36': 2.0, '2015 37': 56.0, '2016 40': 13.0, '2016 27': 77.33333333333333, '2017 32': 14.0, '2018 24': 10.0, '2018 25': 5.0}


 This is for author :
Damn_Madame


{'2018 31': 1.5, '2018 30': 3.0, '2018 32': 0.0, '2018 34': 1.6666666666666667, '2018 26': 1.0, '2018 28': 2.0}


 This is for author :
Eric2517


{'2017 32': 16.0, '2017 34': 3.0, '2018 09': 28.0, '2017 39': 39.0, '2018 07': 4.333333333333333, '2018 01': 3.0, '2018 02': 11.0, '2018 03': 1.5, '2018 08': 107.0, '2017 11': 12.0, '2017 26': 2.0, '2018 19': 1.0, '2018 18': 3.0, '2018 17': 1.0, '2018 30': 5.0, '2018 33': 2.0, '2018 14': 1.0, '2018 13': 3.0, '2018 34': 19.5, '2018 10': 6.5, '2017 47': 5.0, '2018 20': 14.0, '2018 28': 0.0, '2018 29': 1.0}


 This is for author :
Ge0rgeBr0ughton


{'2017 32': 5.0, '2017 33': 0.0, '2017 52': 6.333333333333333, '2017 35': 6.0, '2017 37': 9.0, '2018 04': 12.2, '2018 05': 3.0, '2018 06': 5.0, '2018 01': 10.2, '2018 02': 2.0, '2018 03': 14.857142857142858, '2017 27': 10.5, '2017 34': 6.0, '2018 09': 16.75, '2018 19': 4.666666666666667, '2018 18': 242.0, '2018 16': 4.0, '2018 33': 200.0, '2017 09': 1.0, '2017 08': 1.5, '2018 08': 61.833333333333336, '2017 24': 8.666666666666666, '2017 05': 28.0, '2017 04': 22.0, '2018 15': 35.0, '2018 32': 2.3333333333333335, '2018 13': 2.5, '2018 12': 1.0, '2017 03': 14.333333333333334, '2017 02': 13.666666666666666, '2017 48': 5.8, '2018 11': 1.2, '2018 10': 21.5, '2017 45': 10.0, '2017 47': 7.5, '2017 46': 1.0, '2018 34': 31.0, '2018 30': 2.0, '2018 22': 3.0, '2018 20': 7.0, '2018 35': 4.5, '2018 28': 84.5}


 This is for author :
Gtj_2036


{'2017 30': 45.75, '2017 31': 17.6, '2017 32': 24.25, '2017 19': 5.0, '2017 34': 26.5, '2017 35': 10.5, '2017 50': 13.0, '2017 37': 17.5, '2017 38': 28.4, '2017 39': 8.0, '2018 06': 38.285714285714285, '2018 07': 39.666666666666664, '2018 02': 28.666666666666668, '2018 03': 3.6666666666666665, '2017 33': 4.0, '2017 52': 10.5, '2018 09': 1.8, '2018 08': 26.166666666666668, '2018 19': 12.6, '2017 51': 13.055555555555555, '2018 04': 4.545454545454546, '2018 05': 7.0, '2018 18': 3.0, '2018 15': 10.0, '2018 14': 5.666666666666667, '2017 27': 5.333333333333333, '2017 25': 7.333333333333333, '2017 24': 2.0, '2018 17': 5.714285714285714, '2018 16': 5.615384615384615, '2017 29': 8.0, '2017 28': 7.666666666666667, '2018 13': 8.384615384615385, '2018 12': 4.153846153846154, '2018 11': 83.8, '2018 10': 57.0, '2017 49': 4.333333333333333, '2017 48': 16.444444444444443, '2017 41': 19.8, '2017 40': 6.333333333333333, '2017 43': 10.25, '2017 42': 7.666666666666667, '2017 45': 4.2, '2017 44': 15.25, '2017 47': 86.33333333333333, '2017 46': 8.857142857142858, '2018 30': 3.0, '2018 26': 1.0, '2018 27': 1.0, '2018 24': 0.75, '2018 25': 8.5, '2018 22': 68.4, '2018 23': 35.5, '2018 20': 3.2222222222222223, '2018 21': 22.333333333333332, '2018 28': 1.3333333333333333, '2018 29': 0.0}


 This is for author :
IsAFailure


{'2017 31': 18.0, '2017 34': 2.0, '2017 35': 3.0, '2017 36': 33.0, '2017 37': 5.0, '2017 38': 23.5, '2017 39': 14.0, '2017 50': 7.0, '2017 51': 28.0, '2018 32': 10.0, '2018 16': 15.0, '2018 33': 38.0, '2018 14': 20.0, '2018 35': 35.0, '2017 49': 15.0, '2017 48': 17.0, '2017 41': 1.0, '2017 40': 20.0, '2017 42': 1.0, '2017 45': 5.0, '2017 44': 2.0, '2017 46': 2.0, '2018 22': 33.0, '2018 29': 11.0}


 This is for author :
Ivoriy


{'2017 30': 8.0, '2017 31': 438.0, '2017 32': 1.6666666666666667, '2017 33': 1.5, '2017 34': 4.0, '2017 35': 2.4, '2017 50': 8.0, '2017 51': 1.0, '2017 38': 10.0, '2017 39': 37.333333333333336, '2018 03': 9.0, '2017 52': 4.0, '2018 09': 3.0, '2017 36': 1.0, '2017 37': 12.0, '2018 05': 2.0, '2017 23': 8.0, '2018 08': 3.75, '2017 24': 2.0, '2018 30': 20.0, '2018 33': 5.0, '2017 28': 11.0, '2018 35': 10.0, '2018 34': 0.0, '2018 11': 1.5, '2017 41': 9.333333333333334, '2017 40': 3.4, '2017 43': 9.0, '2017 42': 2.0, '2017 45': 2.75, '2018 27': 1.0, '2018 23': 7.5}


 This is for author :
KnowThat205


{'2018 09': 13.0, '2018 27': 2.0, '2018 04': 12.5, '2018 05': 1.5, '2018 15': 7.0, '2018 12': 6.0, '2018 11': 3.0, '2018 26': 2.0, '2017 48': 10.0, '2018 21': 9.0, '2018 30': 12.0}


 This is for author :
Kookie_212


{'2017 31': 2.5, '2017 33': 7.333333333333333, '2017 37': 11.0, '2018 04': 13.333333333333334, '2017 39': 2.6666666666666665, '2018 02': 6.0, '2017 41': 9.0, '2017 40': 9.0, '2017 43': 3.6666666666666665, '2017 42': 16.0, '2017 45': 26.0, '2017 44': 10.5}


 This is for author :
KriegRipper


{'2017 33': 1.25, '2017 18': 1.2, '2017 19': 3.6, '2017 34': 0.6666666666666666, '2018 09': 40.0, '2017 50': 5.5, '2017 12': 3.0, '2017 13': 6.0, '2018 06': 164.4, '2017 16': 2.0, '2017 17': 3.0, '2017 14': 2.3333333333333335, '2017 15': 4.666666666666667, '2016 51': 1.0, '2016 52': 1.0, '2015 07': 4.0, '2015 06': 9.5, '2017 27': 5.5, '2016 31': 0.0, '2015 08': 14.0, '2018 08': 0.75, '2014 46': 1.0, '2018 31': 32.333333333333336, '2018 21': 2.5, '2018 32': 44.0, '2018 18': 245.0, '2015 43': 9.0, '2014 49': 1.0, '2017 44': 0.0, '2018 04': 4.5, '2018 28': 15.25, '2018 15': 9.0, '2017 23': 4.5, '2017 22': 3.0, '2017 21': 1.0, '2017 20': 1.0, '2017 09': 0.0, '2017 26': 44.5, '2017 25': 0.0, '2017 24': 12.666666666666666, '2018 17': 8054.5, '2018 30': 21.0, '2017 07': 4.0, '2017 06': 1.0, '2017 01': 1.3333333333333333, '2018 12': 12.5, '2017 02': 1.0, '2015 10': 10.0, '2015 11': 1.0, '2015 13': 1.0, '2015 14': 1.0, '2015 15': 1.0, '2016 49': 0.5, '2017 41': 9.5, '2015 33': 1.0, '2018 03': 2.0, '2017 42': 1.0, '2017 45': 0.0, '2016 25': 0.0, '2017 46': 4.5, '2014 35': 3.0, '2017 32': 1.0, '2018 33': 3.0, '2018 34': 75.0, '2014 50': 2.0, '2015 50': 1.0, '2018 01': 17.666666666666668, '2018 26': 12.333333333333334, '2018 27': 133.5, '2018 02': 1.0, '2018 25': 7.0, '2018 22': 38.0, '2018 23': 3.2, '2018 20': 200.0, '2017 49': 24.0, '2018 24': 52.5, '2017 52': 20.0, '2018 10': 7.666666666666667, '2018 29': 48.4}'''
